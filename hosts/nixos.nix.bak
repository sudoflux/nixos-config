{ config, pkgs, inputs,... }: {
  nixpkgs.hostPlatform = "x86_64-linux";
# hyprland configs
  programs.hyprland = {
     enable = true;
     package = inputs.hyprland.packages.${pkgs.system}.hyprland;
     portalPackage = inputs.hyprland.packages.${pkgs.system}.xdg-desktop-portal-hyprland;
  };
  services.xserver = {
    xkb.layout = "us";
    xkb.variant = "";
  };
  services.xserver.videoDrivers = [ "amdgpu" "nvidia" ];
  services.xserver.enable = true;
  services.xserver.displayManager.sddm = {
    enable = true;
    theme = "breeze";
  };
  services.xserver.windowManager.hypr.enable = true;
  
  environment.systemPackages = with pkgs; [ 
    xdg-desktop-portal
    xdg-desktop-portal-hyprland
    wayland
    dbus
    pciutils
    usbutils
    config.boot.kernelPackages.nvidiaPackages.stable.bin
    gnome.adwaita-icon-theme
  ];
  
  environment.variables = {
    XCURSOR_THEME = "Adwaita";
    XCURSOR_SIZE = "24";
  };  

  nix.settings = {
    substituters = ["https://hyprland.cachix.org"];
    trusted-public-keys = ["hyprland.cachix.org-1:a7pgxzMz7+chwVL3/pzj6jIBMioiJM7ypFP8PwtkuGc="];
    experimental-features = [ "nix-command" "flakes" ];
  };

  imports = [ ];
  
  boot.initrd.kernelModules = [ "amdgpu" ];
  hardware.enableRedistributableFirmware = true;

  networking.hostName = "nixos";
  time.timeZone = "America/New_York";

  i18n.defaultLocale = "en_US.UTF-8";

  boot.loader.systemd-boot.enable = true;
  boot.loader.efi.canTouchEfiVariables = true;

  nixpkgs.config.allowUnfree = true;

  fileSystems."/" = {
    device = "/dev/disk/by-label/nixos-root";
    fsType = "ext4";
  };

  fileSystems."/boot" = {
    device = "/dev/disk/by-label/ESP";
    fsType = "vfat";
  };

  swapDevices = [
    {
      device = "/dev/disk/by-label/SWAP";
    }
   ];

  users.users.josh = {
    isNormalUser = true;
    extraGroups = [ "wheel" "networkmanager" ];
    shell = pkgs.zsh;
  };

  programs.zsh.enable = true;
 
  sound.enable = true;
  hardware.pulseaudio.enable = false;
  services.pipewire = {
    enable = true;
    pulse.enable = true;
    alsa.enable = true;
    jack.enable = true;
  };

  networking.networkmanager.enable = true;

# nvidia
  hardware.nvidia = {
    modesetting.enable = true;
    powerManagement.enable = true;
    open = false;
    nvidiaSettings = true;
    package = config.boot.kernelPackages.nvidiaPackages.stable;
  };

# for Wayland
  hardware.opengl.enable = true;

  system.stateVersion = "23.11";
}
